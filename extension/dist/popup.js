(()=>{function e(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}document.addEventListener("DOMContentLoaded",async()=>{const n=document.getElementById("content");async function t(){try{const t=await chrome.storage.local.get(["proofreadResult","originalText","timestamp","isLoading","messages"]);if(!t.originalText)return void(n.innerHTML='\n          <div class="no-result">\n            <p>Êé®Êï≤ÁµêÊûú„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>\n            <p>„ÉÜ„Ç≠„Çπ„Éà„ÇíÈÅ∏Êäû„Åó„Å¶Âè≥„ÇØ„É™„ÉÉ„ÇØ„Åã„Çâ„ÄåAIÊé®Êï≤„Äç„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>\n            <p class="model-info">ü§ñ WebLLM (Llama-3.2-1B) „ÅßÂãï‰Ωú‰∏≠</p>\n          </div>\n        ');const{proofreadResult:s,originalText:i,timestamp:a,isLoading:o,messages:l}=t;if(o)return void(n.innerHTML=`\n          <div class="original-text-section">\n            <div class="original-text-label">üìù ÂÖÉ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà</div>\n            <div class="original-text-content">${e(i)}</div>\n          </div>\n\n          <div class="loading-animation">\n            <div class="spinner"></div>\n            <p>AIÔºàWebLLMÔºâ„ÅåÊé®Êï≤‰∏≠„Åß„Åô„ÄÇ„Åó„Å∞„Çâ„Åè„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ...</p>\n            <p class="loading-note">ÂàùÂõû„ÅØ „É¢„Éá„É´„ÅÆË™≠„ÅøËæº„Åø„Å´ÊôÇÈñì„Åå„Åã„Åã„Çä„Åæ„Åô</p>\n          </div>\n        `);const r=s&&s.startsWith("„Ç®„É©„Éº:");n.innerHTML=`\n        <div class="original-text-section">\n          <div class="original-text-label">üìù ÂÖÉ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà</div>\n          <div class="original-text-content">${e(i)}</div>\n        </div>\n\n        ${function(n,t){return t?`<div class="chat-message assistant">\n      <div class="chat-message-role">AI (WebLLM)</div>\n      <div class="chat-message-bubble" style="background-color: #ffebee; color: #c62828;">\n        ${e(n&&n[1]?n[1].content:"„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü")}\n      </div>\n    </div>`:n&&Array.isArray(n)&&0!==n.length?n.map((n,t)=>{if(0===t&&"user"===n.role)return"";const s="user"===n.role?"„ÅÇ„Å™„Åü":"AI (WebLLM)";return n.isLoading?`\n        <div class="chat-message ${n.role}">\n          <div class="chat-message-role">${s}</div>\n          <div class="chat-message-bubble" style="display: flex; align-items: center; gap: 10px; padding: 12px 14px;">\n            <div class="spinner" style="width: 20px; height: 20px; border-width: 2px; flex-shrink: 0;"></div>\n            <span style="font-size: 13px; color: #666;">ËÄÉ„Åà‰∏≠...</span>\n          </div>\n        </div>\n      `:`\n      <div class="chat-message ${n.role}">\n        <div class="chat-message-role">${s}</div>\n        <div class="chat-message-bubble">${e(n.content)}</div>\n      </div>\n    `}).join(""):'<p style="text-align: center; color: #999; padding: 40px;">‰ºöË©±Â±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>'}(l,r)}\n      `,setTimeout(()=>{n.scrollTop=n.scrollHeight},50);const c=document.getElementById("chatInputArea"),d=document.getElementById("chatInput"),g=document.getElementById("chatSendBtn");if(!r&&l&&c){if(c.style.display="block",d&&g){const e=async()=>{const e=d.value.trim();if(!e)return;d.value="";const n=[...l,{role:"user",content:e},{role:"assistant",content:"ËÄÉ„Åà‰∏≠...",isLoading:!0}];await chrome.storage.local.set({messages:n,timestamp:Date.now()}),g.disabled=!0,d.disabled=!0,g.textContent="ÈÄÅ‰ø°‰∏≠...";try{const n=await chrome.runtime.sendMessage({action:"sendChatMessage",message:e,messages:l,originalText:i});n.success||alert("„Ç®„É©„Éº: "+(n.error||"ÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü"))}catch(e){console.error("Failed to send message:",e),alert("„É°„ÉÉ„Çª„Éº„Ç∏„ÅÆÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü")}finally{g.disabled=!1,d.disabled=!1,g.textContent="ÈÄÅ‰ø°"}};g.addEventListener("click",e),d.addEventListener("keypress",n=>{"Enter"===n.key&&e()})}}else c&&(c.style.display="none")}catch(t){console.error("Error loading result:",t),n.innerHTML=`\n        <div class="no-result">\n          <p>ÁµêÊûú„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ</p>\n          <p>${e(t.message)}</p>\n        </div>\n      `}}await t(),chrome.storage.onChanged.addListener((e,n)=>{"local"===n&&t()}),chrome.runtime.sendMessage({action:"checkEngineStatus"},e=>{!e||e.initialized||e.initializing||console.log("[Popup] Engine not initialized, requesting initialization...")})})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0JBQXlCQSxHQUN2Q2hELEVBQVdILFVBQVkscUZBR2ROLEVBQVd5RCxFQUFNYixzQ0FHNUIsQ0FDRixPQWhKTWpDLElBR05FLE9BQU9DLFFBQVErQyxVQUFVQyxZQUFZLENBQUNDLEVBQVNDLEtBQzNCLFVBQWRBLEdBQ0ZyRCxNQUtKRSxPQUFPd0MsUUFBUVYsWUFBWSxDQUFFVyxPQUFRLHFCQUF3QkYsS0FDdkRBLEdBQWFBLEVBQVNhLGFBQWdCYixFQUFTYyxjQUNqRFIsUUFBUVMsSUFBSSxtRSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLXByb29mcmVhZC1leHRlbnNpb24vLi9zcmMvcG9wdXAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8g44Od44OD44OX44Ki44OD44OX44GM6ZaL44GL44KM44Gf5pmC44Gr57WQ5p6c44KS6KGo56S6XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCBjb250ZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnQnKTtcblxuICAvLyDliJ3lm57oqq3jgb/ovrzjgb9cbiAgYXdhaXQgdXBkYXRlRGlzcGxheSgpO1xuXG4gIC8vIOOCueODiOODrOODvOOCuOOBruWkieabtOOCkuebo+imluOBl+OBpuODquOCouODq+OCv+OCpOODoOabtOaWsFxuICBjaHJvbWUuc3RvcmFnZS5vbkNoYW5nZWQuYWRkTGlzdGVuZXIoKGNoYW5nZXMsIG5hbWVzcGFjZSkgPT4ge1xuICAgIGlmIChuYW1lc3BhY2UgPT09ICdsb2NhbCcpIHtcbiAgICAgIHVwZGF0ZURpc3BsYXkoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIOOCqOODs+OCuOODs+OBruWIneacn+WMlueKtuaFi+OCkuODgeOCp+ODg+OCr1xuICBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSh7IGFjdGlvbjogJ2NoZWNrRW5naW5lU3RhdHVzJyB9LCAocmVzcG9uc2UpID0+IHtcbiAgICBpZiAocmVzcG9uc2UgJiYgIXJlc3BvbnNlLmluaXRpYWxpemVkICYmICFyZXNwb25zZS5pbml0aWFsaXppbmcpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbUG9wdXBdIEVuZ2luZSBub3QgaW5pdGlhbGl6ZWQsIHJlcXVlc3RpbmcgaW5pdGlhbGl6YXRpb24uLi4nKTtcbiAgICB9XG4gIH0pO1xuXG4gIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZURpc3BsYXkoKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOOCueODiOODrOODvOOCuOOBi+OCieebtOaOpeODh+ODvOOCv+OCkuWPluW+l1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChbJ3Byb29mcmVhZFJlc3VsdCcsICdvcmlnaW5hbFRleHQnLCAndGltZXN0YW1wJywgJ2lzTG9hZGluZycsICdtZXNzYWdlcyddKTtcblxuICAgICAgLy8g44OH44O844K/44GM44Gq44GE5aC05ZCIXG4gICAgICBpZiAoIWRhdGEub3JpZ2luYWxUZXh0KSB7XG4gICAgICAgIGNvbnRlbnREaXYuaW5uZXJIVE1MID0gYFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJuby1yZXN1bHRcIj5cbiAgICAgICAgICAgIDxwPuaOqOaVsue1kOaenOOBjOOBguOCiuOBvuOBm+OCk+OAgjwvcD5cbiAgICAgICAgICAgIDxwPuODhuOCreOCueODiOOCkumBuOaKnuOBl+OBpuWPs+OCr+ODquODg+OCr+OBi+OCieOAjEFJ5o6o5pWy44CN44KS6YG45oqe44GX44Gm44GP44Gg44GV44GE44CCPC9wPlxuICAgICAgICAgICAgPHAgY2xhc3M9XCJtb2RlbC1pbmZvXCI+8J+kliBXZWJMTE0gKExsYW1hLTMuMi0xQikg44Gn5YuV5L2c5LitPC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHtwcm9vZnJlYWRSZXN1bHQsIG9yaWdpbmFsVGV4dCwgdGltZXN0YW1wLCBpc0xvYWRpbmcsIG1lc3NhZ2VzfSA9IGRhdGE7XG5cbiAgICAgIC8vIOODreODvOODh+OCo+ODs+OCsOS4reOBruihqOekulxuICAgICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgICBjb250ZW50RGl2LmlubmVySFRNTCA9IGBcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwib3JpZ2luYWwtdGV4dC1zZWN0aW9uXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib3JpZ2luYWwtdGV4dC1sYWJlbFwiPvCfk50g5YWD44Gu44OG44Kt44K544OIPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib3JpZ2luYWwtdGV4dC1jb250ZW50XCI+JHtlc2NhcGVIdG1sKG9yaWdpbmFsVGV4dCl9PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibG9hZGluZy1hbmltYXRpb25cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzcGlubmVyXCI+PC9kaXY+XG4gICAgICAgICAgICA8cD5BSe+8iFdlYkxMTe+8ieOBjOaOqOaVsuS4reOBp+OBmeOAguOBl+OBsOOCieOBj+OBiuW+heOBoeOBj+OBoOOBleOBhC4uLjwvcD5cbiAgICAgICAgICAgIDxwIGNsYXNzPVwibG9hZGluZy1ub3RlXCI+5Yid5Zue44GvIOODouODh+ODq+OBruiqreOBv+i+vOOBv+OBq+aZgumWk+OBjOOBi+OBi+OCiuOBvuOBmTwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDntZDmnpzooajnpLpcbiAgICAgIGNvbnN0IGlzRXJyb3IgPSBwcm9vZnJlYWRSZXN1bHQgJiYgcHJvb2ZyZWFkUmVzdWx0LnN0YXJ0c1dpdGgoJ+OCqOODqeODvDonKTtcblxuICAgICAgLy8g5YWD44Gu44OG44Kt44K544OI44K744Kv44K344On44OzICsg44OB44Oj44OD44OI5bGl5q20XG4gICAgICBjb250ZW50RGl2LmlubmVySFRNTCA9IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm9yaWdpbmFsLXRleHQtc2VjdGlvblwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJvcmlnaW5hbC10ZXh0LWxhYmVsXCI+8J+TnSDlhYPjga7jg4bjgq3jgrnjg4g8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwib3JpZ2luYWwtdGV4dC1jb250ZW50XCI+JHtlc2NhcGVIdG1sKG9yaWdpbmFsVGV4dCl9PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgICR7cmVuZGVyQWxsTWVzc2FnZXMobWVzc2FnZXMsIGlzRXJyb3IpfVxuICAgICAgYDtcblxuICAgICAgLy8g6Ieq5YuV55qE44Gr5LiL44Gr44K544Kv44Ot44O844OrXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29udGVudERpdi5zY3JvbGxUb3AgPSBjb250ZW50RGl2LnNjcm9sbEhlaWdodDtcbiAgICAgIH0sIDUwKTtcblxuICAgICAgLy8g44OB44Oj44OD44OI5YWl5Yqb44Ko44Oq44Ki44KS6KGo56S6XG4gICAgICBjb25zdCBjaGF0SW5wdXRBcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXRJbnB1dEFyZWEnKTtcbiAgICAgIGNvbnN0IGNoYXRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0SW5wdXQnKTtcbiAgICAgIGNvbnN0IGNoYXRTZW5kQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXRTZW5kQnRuJyk7XG5cbiAgICAgIGlmICghaXNFcnJvciAmJiBtZXNzYWdlcyAmJiBjaGF0SW5wdXRBcmVhKSB7XG4gICAgICAgIGNoYXRJbnB1dEFyZWEuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cbiAgICAgICAgLy8g44OB44Oj44OD44OI6YCB5L+h44Oc44K/44Oz44Gu44Kk44OZ44Oz44OI44Oq44K544OK44O8XG4gICAgICAgIGlmIChjaGF0SW5wdXQgJiYgY2hhdFNlbmRCdG4pIHtcbiAgICAgICAgICBjb25zdCBzZW5kTWVzc2FnZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBjaGF0SW5wdXQudmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgaWYgKCFtZXNzYWdlKSByZXR1cm47XG5cbiAgICAgICAgICAgIC8vIOWFpeWKm+ashOOCkuOCr+ODquOCou+8iOWNs+W6p+OBq++8iVxuICAgICAgICAgICAgY2hhdElucHV0LnZhbHVlID0gJyc7XG5cbiAgICAgICAgICAgIC8vIOODpuODvOOCtuODvOODoeODg+OCu+ODvOOCuOOBqOODreODvOODh+OCo+ODs+OCsOihqOekuuOCkuOBmeOBkOOBq+OCueODiOODrOODvOOCuOOBq+i/veWKoO+8iOWNs+W6p+OBq+ihqOekuu+8iVxuICAgICAgICAgICAgY29uc3QgdXBkYXRlZE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzLFxuICAgICAgICAgICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogbWVzc2FnZSB9LFxuICAgICAgICAgICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAn6ICD44GI5LitLi4uJywgaXNMb2FkaW5nOiB0cnVlIH1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe1xuICAgICAgICAgICAgICBtZXNzYWdlczogdXBkYXRlZE1lc3NhZ2VzLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyDjg5zjgr/jg7PjgpLnhKHlirnljJZcbiAgICAgICAgICAgIGNoYXRTZW5kQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNoYXRJbnB1dC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICBjaGF0U2VuZEJ0bi50ZXh0Q29udGVudCA9ICfpgIHkv6HkuK0uLi4nO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdzZW5kQ2hhdE1lc3NhZ2UnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IG1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsVGV4dDogb3JpZ2luYWxUZXh0XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgLy8g5oiQ5Yqf5pmC44Gv5L2V44KC44GX44Gq44GE77yI44K544OI44Os44O844K45pu05paw44Gn6Ieq5YuV55qE44GrVUnjgYzmm7TmlrDjgZXjgozjgovvvIlcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbGVydCgn44Ko44Op44O8OiAnICsgKHJlc3BvbnNlLmVycm9yIHx8ICfpgIHkv6HjgavlpLHmlZfjgZfjgb7jgZfjgZ8nKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzZW5kIG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICAgICAgICBhbGVydCgn44Oh44OD44K744O844K444Gu6YCB5L+h44Gr5aSx5pWX44GX44G+44GX44GfJyk7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICBjaGF0U2VuZEJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBjaGF0SW5wdXQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgY2hhdFNlbmRCdG4udGV4dENvbnRlbnQgPSAn6YCB5L+hJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgY2hhdFNlbmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZW5kTWVzc2FnZSk7XG4gICAgICAgICAgY2hhdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICBzZW5kTWVzc2FnZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNoYXRJbnB1dEFyZWEpIHtcbiAgICAgICAgY2hhdElucHV0QXJlYS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIHJlc3VsdDonLCBlcnJvcik7XG4gICAgICBjb250ZW50RGl2LmlubmVySFRNTCA9IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm5vLXJlc3VsdFwiPlxuICAgICAgICAgIDxwPue1kOaenOOBruiqreOBv+i+vOOBv+OBq+WkseaVl+OBl+OBvuOBl+OBn+OAgjwvcD5cbiAgICAgICAgICA8cD4ke2VzY2FwZUh0bWwoZXJyb3IubWVzc2FnZSl9PC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIGA7XG4gICAgfVxuICB9XG59KTtcblxuLy8gSFRNTOOCqOOCueOCseODvOODl+mWouaVsFxuZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7XG4gIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXYudGV4dENvbnRlbnQgPSB0ZXh0O1xuICByZXR1cm4gZGl2LmlubmVySFRNTDtcbn1cblxuLy8g5YWo44Oh44OD44K744O844K444KS57Wx5LiA44OV44Kp44O844Oe44OD44OI44Gn44Os44Oz44OA44Oq44Oz44Kw44GZ44KL6Zai5pWwXG5mdW5jdGlvbiByZW5kZXJBbGxNZXNzYWdlcyhtZXNzYWdlcywgaXNFcnJvcikge1xuICBpZiAoaXNFcnJvcikge1xuICAgIHJldHVybiBgPGRpdiBjbGFzcz1cImNoYXQtbWVzc2FnZSBhc3Npc3RhbnRcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjaGF0LW1lc3NhZ2Utcm9sZVwiPkFJIChXZWJMTE0pPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiY2hhdC1tZXNzYWdlLWJ1YmJsZVwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2ZmZWJlZTsgY29sb3I6ICNjNjI4Mjg7XCI+XG4gICAgICAgICR7ZXNjYXBlSHRtbChtZXNzYWdlcyAmJiBtZXNzYWdlc1sxXSA/IG1lc3NhZ2VzWzFdLmNvbnRlbnQgOiAn44Ko44Op44O844GM55m655Sf44GX44G+44GX44GfJyl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gO1xuICB9XG5cbiAgaWYgKCFtZXNzYWdlcyB8fCAhQXJyYXkuaXNBcnJheShtZXNzYWdlcykgfHwgbWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICc8cCBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgY29sb3I6ICM5OTk7IHBhZGRpbmc6IDQwcHg7XCI+5Lya6Kmx5bGl5q2044GM44GC44KK44G+44Gb44KTPC9wPic7XG4gIH1cblxuICByZXR1cm4gbWVzc2FnZXMubWFwKChtc2csIGluZGV4KSA9PiB7XG4gICAgLy8g5pyA5Yid44Gu44Om44O844K244O844Oh44OD44K744O844K477yI5o6o5pWy5L6d6aC877yJ44Gv44K544Kt44OD44OXXG4gICAgaWYgKGluZGV4ID09PSAwICYmIG1zZy5yb2xlID09PSAndXNlcicpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBjb25zdCByb2xlTGFiZWwgPSBtc2cucm9sZSA9PT0gJ3VzZXInID8gJ+OBguOBquOBnycgOiAnQUkgKFdlYkxMTSknO1xuXG4gICAgLy8g44Ot44O844OH44Kj44Oz44Kw5Lit44Gu5aC05ZCI44Gv44K544OU44OK44O844KS6KGo56S6XG4gICAgaWYgKG1zZy5pc0xvYWRpbmcpIHtcbiAgICAgIHJldHVybiBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjaGF0LW1lc3NhZ2UgJHttc2cucm9sZX1cIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdC1tZXNzYWdlLXJvbGVcIj4ke3JvbGVMYWJlbH08L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdC1tZXNzYWdlLWJ1YmJsZVwiIHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiAxMHB4OyBwYWRkaW5nOiAxMnB4IDE0cHg7XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3Bpbm5lclwiIHN0eWxlPVwid2lkdGg6IDIwcHg7IGhlaWdodDogMjBweDsgYm9yZGVyLXdpZHRoOiAycHg7IGZsZXgtc2hyaW5rOiAwO1wiPjwvZGl2PlxuICAgICAgICAgICAgPHNwYW4gc3R5bGU9XCJmb250LXNpemU6IDEzcHg7IGNvbG9yOiAjNjY2O1wiPuiAg+OBiOS4rS4uLjwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgO1xuICAgIH1cblxuICAgIHJldHVybiBgXG4gICAgICA8ZGl2IGNsYXNzPVwiY2hhdC1tZXNzYWdlICR7bXNnLnJvbGV9XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjaGF0LW1lc3NhZ2Utcm9sZVwiPiR7cm9sZUxhYmVsfTwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdC1tZXNzYWdlLWJ1YmJsZVwiPiR7ZXNjYXBlSHRtbChtc2cuY29udGVudCl9PC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICB9KS5qb2luKCcnKTtcbn0iXSwibmFtZXMiOlsiZXNjYXBlSHRtbCIsInRleHQiLCJkaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImlubmVySFRNTCIsImFkZEV2ZW50TGlzdGVuZXIiLCJhc3luYyIsImNvbnRlbnREaXYiLCJnZXRFbGVtZW50QnlJZCIsInVwZGF0ZURpc3BsYXkiLCJkYXRhIiwiY2hyb21lIiwic3RvcmFnZSIsImxvY2FsIiwiZ2V0Iiwib3JpZ2luYWxUZXh0IiwicHJvb2ZyZWFkUmVzdWx0IiwidGltZXN0YW1wIiwiaXNMb2FkaW5nIiwibWVzc2FnZXMiLCJpc0Vycm9yIiwic3RhcnRzV2l0aCIsImNvbnRlbnQiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJtYXAiLCJtc2ciLCJpbmRleCIsInJvbGUiLCJyb2xlTGFiZWwiLCJqb2luIiwicmVuZGVyQWxsTWVzc2FnZXMiLCJzZXRUaW1lb3V0Iiwic2Nyb2xsVG9wIiwic2Nyb2xsSGVpZ2h0IiwiY2hhdElucHV0QXJlYSIsImNoYXRJbnB1dCIsImNoYXRTZW5kQnRuIiwic3R5bGUiLCJkaXNwbGF5Iiwic2VuZE1lc3NhZ2UiLCJtZXNzYWdlIiwidmFsdWUiLCJ0cmltIiwidXBkYXRlZE1lc3NhZ2VzIiwic2V0IiwiRGF0ZSIsIm5vdyIsImRpc2FibGVkIiwicmVzcG9uc2UiLCJydW50aW1lIiwiYWN0aW9uIiwic3VjY2VzcyIsImFsZXJ0IiwiZXJyb3IiLCJjb25zb2xlIiwiZSIsImtleSIsIm9uQ2hhbmdlZCIsImFkZExpc3RlbmVyIiwiY2hhbmdlcyIsIm5hbWVzcGFjZSIsImluaXRpYWxpemVkIiwiaW5pdGlhbGl6aW5nIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==